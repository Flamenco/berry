---
slug: release/4.0
title: "Release: Yarn 4.0 ü™Ñ‚öóÔ∏è"
authors: [arcanis]
---

import {TerminalRender} from '@yarnpkg/docusaurus/src/components/TerminalRender';

Today is the day! After more than a year of work, our team is excited to finally put a fancy "stable" sticker on the first release from the 4.x release line! To celebrate, let's make together a tour of the major changes; should you look for a more itemized list, take a look at the [changelog](/advanced/changelog#400).

## Breaking Changes

Those couple of items deserve particular attention when upgrading from 3.x projects:

- We now require Node.js 18+.
- New projects created with `yarn init` won't enable [Zero-Install](http://localhost:3000/features/caching#zero-installs) by default anymore.
- New projects created with `yarn init` will use [Corepack](https://nodejs.org/api/corepack.html) rather than `yarnPath`.
- All official plugins (`typescript`, `interactive-tools`, ...) are now included by default.
- The `yarn workspaces foreach` command has a slightly altered syntax.
- The documentation got a major overhaul (as you can see üòÅ).

## Installing Yarn

Ever since the 2.0 our recommendation has been to install Yarn on a per-project basis using the `yarnPath` setting (automatically set either of `yarn init -2` and `yarn set version`).

We still support `yarnPath`, but both of those commands will now use [Corepack](https://nodejs.org/api/corepack.html) by default; Corepack is the standard utility shipped with Node.js that automatically selects the right package manager version to run depending on the project you're working on.

From now on, no need to check-in the Yarn binary anymore: just set the [`packageManager`](https://nodejs.org/api/packages.html#packagemanager) field (ideally via `yarn init -2` or `yarn set version`), and your team is ready to go.

## JavaScript Constraints

Yarn is the only package manager to implement a [constraints engine](http://localhost:3000/features/constraints). If you don't know it, this feature lets you define a set of rules that your project must satisfy. For instance, the Yarn repository enforces that no two workspaces depend on different versions of any given dependencies, unless explicitly allowed.

Our constraints engine used to be powered by Tau-Prolog, a JavaScript [Prolog](https://en.wikipedia.org/wiki/Prolog#Rules_and_facts) implementation. Unlike imperative languages like JavaScript, Prolog uses a different model called logic programming - you define that something exists if a rule is true. It's a very interesting pattern that integrates well with the concept of rule-based linting.

Unfortunately, Prolog proved too complex to use, increasing the learning curve of constraints past the threshold we were comfortable with. As a result, Prolog constraints are deprecated starting from Yarn 4, and are replaced by a shiny new JavaScript-based engine, with optional TypeScript support!

Jump to the [documentation](/features/constraints#putting-it-all-together) for a quick example to get started.

## New Native Features



## Improved User Interface

Various pieces of the UI got revamped to better convey information. For example, `yarn install` now tells you the packages you added, and their total weight:

import addNextTerm from './2023-09-04-release-4.0--add-next.term.dat';

<TerminalRender content={addNextTerm}/>

Or the `yarn config` command, which sports a new tree display. It now also accepts an arbitrary number of settings as positional arguments, letting you select precisely what you're interested in.

import configTerm from './2023-09-04-release-4.0--config.term.dat';

<TerminalRender content={configTerm}/>
